      subroutine vbic_4T_it_cf_f(p,Vbei,Vbex,Vbci,Vbep,Vbcp,Vrcx,Vbcx
     +,Vrci,Vrbx,Vrbi,Vre,Vrbp,Vrs,Vbe,Vbc,Ibe,Ibex,Itzf,Itzr,Ibc,Ibep
     +,Ircx,Irci,Irbx,Irbi,Ire,Irbp,Qbe,Qbex,Qbc,Qbcx,Qbep,Qbeo,Qbco
     +,Ibcp,Iccp,Irs,Qbcp,SCALE)
      implicit double precision (a-z)
      double precision p(108)
c
c     Function only code
c
      Vtv=1.380662e-23*(2.731500e+02+p(1))/1.602189e-19
      if(p(52).GT.0.0)then
         IVEF=1.0/p(52)
      else
         IVEF=0.0
      endif
      if(p(53).GT.0.0)then
         IVER=1.0/p(53)
      else
         IVER=0.0
      endif
      if(p(54).GT.0.0)then
         IIKF=1.0/p(54)
      else
         IIKF=0.0
      endif
      if(p(55).GT.0.0)then
         IIKR=1.0/p(55)
      else
         IIKR=0.0
      endif
      if(p(56).GT.0.0)then
         IIKP=1.0/p(56)
      else
         IIKP=0.0
      endif
      if(p(4).GT.0.0)then
         IVO=1.0/p(4)
      else
         IVO=0.0
      endif
      if(p(6).GT.0.0)then
         IHRCF=1.0/p(6)
      else
         IHRCF=0.0
      endif
      if(p(60).GT.0.0)then
         IVTF=1.0/p(60)
      else
         IVTF=0.0
      endif
      if(p(61).GT.0.0)then
         IITF=1.0/p(61)
      else
         IITF=0.0
      endif
      if(p(61).GT.0.0)then
         slTF=0.0
      else
         slTF=1.0
      endif
      dv0=-p(18)*p(15)
      if(p(20).LE.0.0)then
         dvh=Vbei+dv0
         if(dvh.GT.0.0)then
            xvar1=(1.0-p(15))
            xvar2=(-1.0-p(19))
            pwq=xvar1**xvar2
            qlo=p(18)*(1.0-pwq*(1.0-p(15))*(1.0-p(15)))/(1.0-p(19))
            qhi=dvh*(1.0-p(15)+0.5*p(19)*dvh/p(18))*pwq
         else
            xvar1=(1.0-Vbei/p(18))
            xvar2=(1.0-p(19))
            xvar3=xvar1**xvar2
            qlo=p(18)*(1.0-xvar3)/(1.0-p(19))
            qhi=0.0
         endif
         qdbe=qlo+qhi
      else
         mv0=sqrt(dv0*dv0+4.0*p(20)*p(20))
         vl0=-0.5*(dv0+mv0)
         xvar1=(1.0-vl0/p(18))
         xvar2=(1.0-p(19))
         xvar3=xvar1**xvar2
         q0=-p(18)*xvar3/(1.0-p(19))
         dv=Vbei+dv0
         mv=sqrt(dv*dv+4.0*p(20)*p(20))
         vl=0.5*(dv-mv)-dv0
         xvar1=(1.0-vl/p(18))
         xvar2=(1.0-p(19))
         xvar3=xvar1**xvar2
         qlo=-p(18)*xvar3/(1.0-p(19))
         xvar1=(1.0-p(15))
         xvar2=(-p(19))
         xvar3=xvar1**xvar2
         qdbe=qlo+xvar3*(Vbei-vl+vl0)-q0
      endif
      dv0=-p(18)*p(15)
      if(p(20).LE.0.0)then
         dvh=Vbex+dv0
         if(dvh.GT.0.0)then
            xvar1=(1.0-p(15))
            xvar2=(-1.0-p(19))
            pwq=xvar1**xvar2
            qlo=p(18)*(1.0-pwq*(1.0-p(15))*(1.0-p(15)))/(1.0-p(19))
            qhi=dvh*(1.0-p(15)+0.5*p(19)*dvh/p(18))*pwq
         else
            xvar1=(1.0-Vbex/p(18))
            xvar2=(1.0-p(19))
            xvar3=xvar1**xvar2
            qlo=p(18)*(1.0-xvar3)/(1.0-p(19))
            qhi=0.0
         endif
         qdbex=qlo+qhi
      else
         mv0=sqrt(dv0*dv0+4.0*p(20)*p(20))
         vl0=-0.5*(dv0+mv0)
         xvar1=(1.0-vl0/p(18))
         xvar2=(1.0-p(19))
         xvar3=xvar1**xvar2
         q0=-p(18)*xvar3/(1.0-p(19))
         dv=Vbex+dv0
         mv=sqrt(dv*dv+4.0*p(20)*p(20))
         vl=0.5*(dv-mv)-dv0
         xvar1=(1.0-vl/p(18))
         xvar2=(1.0-p(19))
         xvar3=xvar1**xvar2
         qlo=-p(18)*xvar3/(1.0-p(19))
         xvar1=(1.0-p(15))
         xvar2=(-p(19))
         xvar3=xvar1**xvar2
         qdbex=qlo+xvar3*(Vbex-vl+vl0)-q0
      endif
      dv0=-p(25)*p(15)
      if(p(27).LE.0.0)then
         dvh=Vbci+dv0
         if(dvh.GT.0.0)then
            xvar1=(1.0-p(15))
            xvar2=(-1.0-p(26))
            pwq=xvar1**xvar2
            qlo=p(25)*(1.0-pwq*(1.0-p(15))*(1.0-p(15)))/(1.0-p(26))
            qhi=dvh*(1.0-p(15)+0.5*p(26)*dvh/p(25))*pwq
         else
            if((p(86).GT.0.0).AND.(Vbci.LT.-p(86)))then
               xvar1=(1.0+p(86)/p(25))
               xvar2=(1.0-p(26))
               xvar3=xvar1**xvar2
               qlo=p(25)*(1.0-xvar3*(1.0-((1.0-p(26))*(Vbci+p(86)))/(p(2
     +5)+p(86))))/(1.0-p(26))
            else
               xvar1=(1.0-Vbci/p(25))
               xvar2=(1.0-p(26))
               xvar3=xvar1**xvar2
               qlo=p(25)*(1.0-xvar3)/(1.0-p(26))
            endif
            qhi=0.0
         endif
         qdbc=qlo+qhi
      else
         if((p(86).GT.0.0).AND.(p(87).GT.0.0))then
            vn0=(p(86)+dv0)/(p(86)-dv0)
            vnl0=2.0*vn0/(sqrt((vn0-1.0)*(vn0-1.0)+4.0*p(27)*p(27))+sqrt
     +((vn0+1.0)*(vn0+1.0)+4.0*p(87)*p(87)))
            vl0=0.5*(vnl0*(p(86)-dv0)-p(86)-dv0)
            xvar1=(1.0-vl0/p(25))
            xvar2=(1.0-p(26))
            xvar3=xvar1**xvar2
            qlo0=p(25)*(1.0-xvar3)/(1.0-p(26))
            vn=(2.0*Vbci+p(86)+dv0)/(p(86)-dv0)
            vnl=2.0*vn/(sqrt((vn-1.0)*(vn-1.0)+4.0*p(27)*p(27))+sqrt((vn
     ++1.0)*(vn+1.0)+4.0*p(87)*p(87)))
            vl=0.5*(vnl*(p(86)-dv0)-p(86)-dv0)
            xvar1=(1.0-vl/p(25))
            xvar2=(1.0-p(26))
            xvar3=xvar1**xvar2
            qlo=p(25)*(1.0-xvar3)/(1.0-p(26))
            sel=0.5*(vnl+1.0)
            xvar1=(1.0+p(86)/p(25))
            xvar2=(-p(26))
            crt=xvar1**xvar2
            xvar1=(1.0+dv0/p(25))
            xvar2=(-p(26))
            cmx=xvar1**xvar2
            cl=(1.0-sel)*crt+sel*cmx
            ql=(Vbci-vl+vl0)*cl
            qdbc=ql+qlo-qlo0
         else
            mv0=sqrt(dv0*dv0+4.0*p(27)*p(27))
            vl0=-0.5*(dv0+mv0)
            xvar1=(1.0-vl0/p(25))
            xvar2=(1.0-p(26))
            xvar3=xvar1**xvar2
            q0=-p(25)*xvar3/(1.0-p(26))
            dv=Vbci+dv0
            mv=sqrt(dv*dv+4.0*p(27)*p(27))
            vl=0.5*(dv-mv)-dv0
            xvar1=(1.0-vl/p(25))
            xvar2=(1.0-p(26))
            xvar3=xvar1**xvar2
            qlo=-p(25)*xvar3/(1.0-p(26))
            xvar1=(1.0-p(15))
            xvar2=(-p(26))
            xvar3=xvar1**xvar2
            qdbc=qlo+xvar3*(Vbci-vl+vl0)-q0
         endif
      endif
      dv0=-p(25)*p(15)
      if(p(27).LE.0.0)then
         dvh=Vbep+dv0
         if(dvh.GT.0.0)then
            xvar1=(1.0-p(15))
            xvar2=(-1.0-p(26))
            pwq=xvar1**xvar2
            qlo=p(25)*(1.0-pwq*(1.0-p(15))*(1.0-p(15)))/(1.0-p(26))
            qhi=dvh*(1.0-p(15)+0.5*p(26)*dvh/p(25))*pwq
         else
            if((p(86).GT.0.0).AND.(Vbep.LT.-p(86)))then
               xvar1=(1.0+p(86)/p(25))
               xvar2=(1.0-p(26))
               xvar3=xvar1**xvar2
               qlo=p(25)*(1.0-xvar3*(1.0-((1.0-p(26))*(Vbep+p(86)))/(p(2
     +5)+p(86))))/(1.0-p(26))
            else
               xvar1=(1.0-Vbep/p(25))
               xvar2=(1.0-p(26))
               xvar3=xvar1**xvar2
               qlo=p(25)*(1.0-xvar3)/(1.0-p(26))
            endif
            qhi=0.0
         endif
         qdbep=qlo+qhi
      else
         if((p(86).GT.0.0).AND.(p(87).GT.0.0))then
            vn0=(p(86)+dv0)/(p(86)-dv0)
            vnl0=2.0*vn0/(sqrt((vn0-1.0)*(vn0-1.0)+4.0*p(27)*p(27))+sqrt
     +((vn0+1.0)*(vn0+1.0)+4.0*p(87)*p(87)))
            vl0=0.5*(vnl0*(p(86)-dv0)-p(86)-dv0)
            xvar1=(1.0-vl0/p(25))
            xvar2=(1.0-p(26))
            xvar3=xvar1**xvar2
            qlo0=p(25)*(1.0-xvar3)/(1.0-p(26))
            vn=(2.0*Vbep+p(86)+dv0)/(p(86)-dv0)
            vnl=2.0*vn/(sqrt((vn-1.0)*(vn-1.0)+4.0*p(27)*p(27))+sqrt((vn
     ++1.0)*(vn+1.0)+4.0*p(87)*p(87)))
            vl=0.5*(vnl*(p(86)-dv0)-p(86)-dv0)
            xvar1=(1.0-vl/p(25))
            xvar2=(1.0-p(26))
            xvar3=xvar1**xvar2
            qlo=p(25)*(1.0-xvar3)/(1.0-p(26))
            sel=0.5*(vnl+1.0)
            xvar1=(1.0+p(86)/p(25))
            xvar2=(-p(26))
            crt=xvar1**xvar2
            xvar1=(1.0+dv0/p(25))
            xvar2=(-p(26))
            cmx=xvar1**xvar2
            cl=(1.0-sel)*crt+sel*cmx
            ql=(Vbep-vl+vl0)*cl
            qdbep=ql+qlo-qlo0
         else
            mv0=sqrt(dv0*dv0+4.0*p(27)*p(27))
            vl0=-0.5*(dv0+mv0)
            xvar1=(1.0-vl0/p(25))
            xvar2=(1.0-p(26))
            xvar3=xvar1**xvar2
            q0=-p(25)*xvar3/(1.0-p(26))
            dv=Vbep+dv0
            mv=sqrt(dv*dv+4.0*p(27)*p(27))
            vl=0.5*(dv-mv)-dv0
            xvar1=(1.0-vl/p(25))
            xvar2=(1.0-p(26))
            xvar3=xvar1**xvar2
            qlo=-p(25)*xvar3/(1.0-p(26))
            xvar1=(1.0-p(15))
            xvar2=(-p(26))
            xvar3=xvar1**xvar2
            qdbep=qlo+xvar3*(Vbep-vl+vl0)-q0
         endif
      endif
      if(p(28).GT.0.0)then
         dv0=-p(29)*p(15)
         if(p(31).LE.0.0)then
            dvh=Vbcp+dv0
            if(dvh.GT.0.0)then
               xvar1=(1.0-p(15))
               xvar2=(-1.0-p(30))
               pwq=xvar1**xvar2
               qlo=p(29)*(1.0-pwq*(1.0-p(15))*(1.0-p(15)))/(1.0-p(30))
               qhi=dvh*(1.0-p(15)+0.5*p(30)*dvh/p(29))*pwq
            else
               xvar1=(1.0-Vbcp/p(29))
               xvar2=(1.0-p(30))
               xvar3=xvar1**xvar2
               qlo=p(29)*(1.0-xvar3)/(1.0-p(30))
               qhi=0.0
            endif
            qdbcp=qlo+qhi
         else
            mv0=sqrt(dv0*dv0+4.0*p(31)*p(31))
            vl0=-0.5*(dv0+mv0)
            xvar1=(1.0-vl0/p(29))
            xvar2=(1.0-p(30))
            xvar3=xvar1**xvar2
            q0=-p(29)*xvar3/(1.0-p(30))
            dv=Vbcp+dv0
            mv=sqrt(dv*dv+4.0*p(31)*p(31))
            vl=0.5*(dv-mv)-dv0
            xvar1=(1.0-vl/p(29))
            xvar2=(1.0-p(30))
            xvar3=xvar1**xvar2
            qlo=-p(29)*xvar3/(1.0-p(30))
            xvar1=(1.0-p(15))
            xvar2=(-p(30))
            xvar3=xvar1**xvar2
            qdbcp=qlo+xvar3*(Vbcp-vl+vl0)-q0
         endif
      else
         qdbcp=0.0
      endif
      argi=Vbei/(p(13)*Vtv)
      if(argi.GT.100.0)then
         expi=exp(100.0)*(1.0+(argi-100.0))
      elseif(argi.LT.-100.0)then
         expi=exp(-100.0)*(1.0+(argi+100.0))
      else
         expi=exp(argi)
      endif
      Ifi=p(12)*(expi-1.0)
      argi=Vbci/(p(14)*Vtv)
      if(argi.GT.100.0)then
         expi=exp(100.0)*(1.0+(argi-100.0))
      elseif(argi.LT.-100.0)then
         expi=exp(-100.0)*(1.0+(argi+100.0))
      else
         expi=exp(argi)
      endif
      Iri=p(12)*p(95)*(expi-1.0)
      q1z=1.0+qdbe*IVER+qdbc*IVEF
      q1=0.5*(sqrt((q1z-1.0e-4)*(q1z-1.0e-4)+1.0e-8)+q1z-1.0e-4)+1.0e-4
      q2=Ifi*IIKF+Iri*IIKR
      if(p(89).LT.0.5)then
         xvar2=1.0/p(90)
         xvar3=q1**xvar2
         xvar1=(xvar3+4.0*q2)
         xvar4=xvar1**p(90)
         qb=0.5*(q1+xvar4)
      else
         xvar1=(1.0+4.0*q2)
         xvar2=xvar1**p(90)
         qb=0.5*q1*(1.0+xvar2)
      endif
      Itzr=Iri/qb
      Itzf=Ifi/qb
      if(p(43).GT.0.0)then
         argi=Vbep/(p(45)*Vtv)
         if(argi.GT.100.0)then
            expi=exp(100.0)*(1.0+(argi-100.0))
         elseif(argi.LT.-100.0)then
            expi=exp(-100.0)*(1.0+(argi+100.0))
         else
            expi=exp(argi)
         endif
         argx=Vbci/(p(45)*Vtv)
         if(argx.GT.100.0)then
            expx=exp(100.0)*(1.0+(argx-100.0))
         elseif(argx.LT.-100.0)then
            expx=exp(-100.0)*(1.0+(argx+100.0))
         else
            expx=exp(argx)
         endif
         Ifp=p(43)*(p(44)*expi+(1.0-p(44))*expx-1.0)
         q2p=Ifp*IIKP
         qbp=0.5*(1.0+sqrt(1.0+4.0*q2p))
         argi=Vbcp/(p(45)*Vtv)
         if(argi.GT.100.0)then
            expi=exp(100.0)*(1.0+(argi-100.0))
         elseif(argi.LT.-100.0)then
            expi=exp(-100.0)*(1.0+(argi+100.0))
         else
            expi=exp(argi)
         endif
         Irp=p(43)*(expi-1.0)
         Iccp=(Ifp-Irp)/qbp
      else
         Ifp=0.0
         qbp=1.0
         Iccp=0.0
      endif
      if(p(33).EQ.1.0)then
         argi=Vbei/(p(34)*Vtv)
         if(argi.GT.100.0)then
            expi=exp(100.0)*(1.0+(argi-100.0))
         elseif(argi.LT.-100.0)then
            expi=exp(-100.0)*(1.0+(argi+100.0))
         else
            expi=exp(argi)
         endif
         argn=Vbei/(p(36)*Vtv)
         if(argn.GT.100.0)then
            expn=exp(100.0)*(1.0+(argn-100.0))
         elseif(argn.LT.-100.0)then
            expn=exp(-100.0)*(1.0+(argn+100.0))
         else
            expn=exp(argn)
         endif
         if(p(99).GT.0.0)then
            argx=(-p(99)-Vbei)/(p(100)*Vtv)
            if(argx.GT.100.0)then
               expx=exp(100.0)*(1.0+(argx-100.0))
            elseif(argx.LT.-100.0)then
               expx=exp(-100.0)*(1.0+(argx+100.0))
            else
               expx=exp(argx)
            endif
            Ibe=p(32)*(expi-1.0)+p(35)*(expn-1.0)-p(101)*(expx-p(105))
         else
            Ibe=p(32)*(expi-1.0)+p(35)*(expn-1.0)
         endif
         Ibex=0.0
      elseif(p(33).EQ.0.0)then
         Ibe=0.0
         argi=Vbex/(p(34)*Vtv)
         if(argi.GT.100.0)then
            expi=exp(100.0)*(1.0+(argi-100.0))
         elseif(argi.LT.-100.0)then
            expi=exp(-100.0)*(1.0+(argi+100.0))
         else
            expi=exp(argi)
         endif
         argn=Vbex/(p(36)*Vtv)
         if(argn.GT.100.0)then
            expn=exp(100.0)*(1.0+(argn-100.0))
         elseif(argn.LT.-100.0)then
            expn=exp(-100.0)*(1.0+(argn+100.0))
         else
            expn=exp(argn)
         endif
         if(p(99).GT.0.0)then
            argx=(-p(99)-Vbex)/(p(100)*Vtv)
            if(argx.GT.100.0)then
               expx=exp(100.0)*(1.0+(argx-100.0))
            elseif(argx.LT.-100.0)then
               expx=exp(-100.0)*(1.0+(argx+100.0))
            else
               expx=exp(argx)
            endif
            Ibex=p(32)*(expi-1.0)+p(35)*(expn-1.0)-p(101)*(expx-p(105))
         else
            Ibex=p(32)*(expi-1.0)+p(35)*(expn-1.0)
         endif
      else
         argi=Vbei/(p(34)*Vtv)
         if(argi.GT.100.0)then
            expi=exp(100.0)*(1.0+(argi-100.0))
         elseif(argi.LT.-100.0)then
            expi=exp(-100.0)*(1.0+(argi+100.0))
         else
            expi=exp(argi)
         endif
         argn=Vbei/(p(36)*Vtv)
         if(argn.GT.100.0)then
            expn=exp(100.0)*(1.0+(argn-100.0))
         elseif(argn.LT.-100.0)then
            expn=exp(-100.0)*(1.0+(argn+100.0))
         else
            expn=exp(argn)
         endif
         if(p(99).GT.0.0)then
            argx=(-p(99)-Vbei)/(p(100)*Vtv)
            if(argx.GT.100.0)then
               expx=exp(100.0)*(1.0+(argx-100.0))
            elseif(argx.LT.-100.0)then
               expx=exp(-100.0)*(1.0+(argx+100.0))
            else
               expx=exp(argx)
            endif
            Ibe=p(33)*(p(32)*(expi-1.0)+p(35)*(expn-1.0)-p(101)*(expx-p(
     +105)))
         else
            Ibe=p(33)*(p(32)*(expi-1.0)+p(35)*(expn-1.0))
         endif
         argi=Vbex/(p(34)*Vtv)
         if(argi.GT.100.0)then
            expi=exp(100.0)*(1.0+(argi-100.0))
         elseif(argi.LT.-100.0)then
            expi=exp(-100.0)*(1.0+(argi+100.0))
         else
            expi=exp(argi)
         endif
         argn=Vbex/(p(36)*Vtv)
         if(argn.GT.100.0)then
            expn=exp(100.0)*(1.0+(argn-100.0))
         elseif(argn.LT.-100.0)then
            expn=exp(-100.0)*(1.0+(argn+100.0))
         else
            expn=exp(argn)
         endif
         if(p(99).GT.0.0)then
            argx=(-p(99)-Vbex)/(p(100)*Vtv)
            if(argx.GT.100.0)then
               expx=exp(100.0)*(1.0+(argx-100.0))
            elseif(argx.LT.-100.0)then
               expx=exp(-100.0)*(1.0+(argx+100.0))
            else
               expx=exp(argx)
            endif
            Ibex=(1.0-p(33))*(p(32)*(expi-1.0)+p(35)*(expn-1.0)-p(101)*(
     +expx-p(105)))
         else
            Ibex=(1.0-p(33))*(p(32)*(expi-1.0)+p(35)*(expn-1.0))
         endif
      endif
      argi=Vbci/(p(38)*Vtv)
      if(argi.GT.100.0)then
         expi=exp(100.0)*(1.0+(argi-100.0))
      elseif(argi.LT.-100.0)then
         expi=exp(-100.0)*(1.0+(argi+100.0))
      else
         expi=exp(argi)
      endif
      argn=Vbci/(p(40)*Vtv)
      if(argn.GT.100.0)then
         expn=exp(100.0)*(1.0+(argn-100.0))
      elseif(argn.LT.-100.0)then
         expn=exp(-100.0)*(1.0+(argn+100.0))
      else
         expn=exp(argn)
      endif
      Ibcj=p(37)*(expi-1.0)+p(39)*(expn-1.0)
      if((p(46).GT.0.0).OR.(p(47).GT.0.0))then
         argi=Vbep/(p(38)*Vtv)
         if(argi.GT.100.0)then
            expi=exp(100.0)*(1.0+(argi-100.0))
         elseif(argi.LT.-100.0)then
            expi=exp(-100.0)*(1.0+(argi+100.0))
         else
            expi=exp(argi)
         endif
         argn=Vbep/(p(40)*Vtv)
         if(argn.GT.100.0)then
            expn=exp(100.0)*(1.0+(argn-100.0))
         elseif(argn.LT.-100.0)then
            expn=exp(-100.0)*(1.0+(argn+100.0))
         else
            expn=exp(argn)
         endif
         Ibep=p(46)*(expi-1.0)+p(47)*(expn-1.0)
      else
         Ibep=0.0
      endif
      if(p(41).GT.0.0)then
         vl=0.5*(sqrt((p(25)-Vbci)*(p(25)-Vbci)+0.01)+(p(25)-Vbci))
         xvar2=(p(26)-1.0)
         xvar3=vl**xvar2
         xvar1=-p(42)*xvar3
         if(xvar1.GT.100.0)then
            xvar4=exp(100.0)*(1.0+(xvar1-100.0))
         elseif(xvar1.LT.-100.0)then
            xvar4=exp(-100.0)*(1.0+(xvar1+100.0))
         else
            xvar4=exp(xvar1)
         endif
         avalf=p(41)*vl*xvar4
         Igc=(Itzf-Itzr-Ibcj)*avalf
      else
         Igc=0.0
      endif
      Ibc=Ibcj-Igc
      if(p(2).GT.0.0)then
         Ircx=Vrcx/p(2)
      else
         Ircx=0.0
      endif
      argi=Vbci/Vtv
      if(argi.GT.100.0)then
         expi=exp(100.0)*(1.0+(argi-100.0))
      elseif(argi.LT.-100.0)then
         expi=exp(-100.0)*(1.0+(argi+100.0))
      else
         expi=exp(argi)
      endif
      argx=Vbcx/Vtv
      if(argx.GT.100.0)then
         expx=exp(100.0)*(1.0+(argx-100.0))
      elseif(argx.LT.-100.0)then
         expx=exp(-100.0)*(1.0+(argx+100.0))
      else
         expx=exp(argx)
      endif
      Kbci=sqrt(1.0+p(5)*expi)
      Kbcx=sqrt(1.0+p(5)*expx)
      if(p(3).GT.0.0)then
         rKp1=(Kbci+1.0)/(Kbcx+1.0)
         xvar1=log(rKp1)
         Iohm=(Vrci+Vtv*(Kbci-Kbcx-xvar1))/p(3)
         derf=IVO*p(3)*Iohm/(1.0+0.5*IVO*IHRCF*sqrt(Vrci*Vrci+0.01))
         Irci=Iohm/sqrt(1.0+derf*derf)
      else
         Irci=0.0
      endif
      if(p(7).GT.0.0)then
         Irbx=Vrbx/p(7)
      else
         Irbx=0.0
      endif
      if(p(8).GT.0.0)then
         Irbi=Vrbi*qb/p(8)
      else
         Irbi=0.0
      endif
      if(p(9).GT.0.0)then
         Ire=Vre/p(9)
      else
         Ire=0.0
      endif
      if(p(11).GT.0.0)then
         Irbp=Vrbp*qbp/p(11)
      else
         Irbp=0.0
      endif
      if((p(48).GT.0.0).OR.(p(50).GT.0.0))then
         argi=Vbcp/(p(49)*Vtv)
         if(argi.GT.100.0)then
            expi=exp(100.0)*(1.0+(argi-100.0))
         elseif(argi.LT.-100.0)then
            expi=exp(-100.0)*(1.0+(argi+100.0))
         else
            expi=exp(argi)
         endif
         argn=Vbcp/(p(51)*Vtv)
         if(argn.GT.100.0)then
            expn=exp(100.0)*(1.0+(argn-100.0))
         elseif(argn.LT.-100.0)then
            expn=exp(-100.0)*(1.0+(argn+100.0))
         else
            expn=exp(argn)
         endif
         Ibcp=p(48)*(expi-1.0)+p(50)*(expn-1.0)
      else
         Ibcp=0.0
      endif
      if(p(10).GT.0.0)then
         Irs=Vrs/p(10)
      else
         Irs=0.0
      endif
      if(Ifi.GT.0.0)then
         sgIf=1.0
      else
         sgIf=0.0
      endif
      rIf=Ifi*sgIf*IITF
      mIf=rIf/(rIf+1.0)
      xvar1=Vbci*IVTF/1.44
      if(xvar1.GT.100.0)then
         xvar2=exp(100.0)*(1.0+(xvar1-100.0))
      elseif(xvar1.LT.-100.0)then
         xvar2=exp(-100.0)*(1.0+(xvar1+100.0))
      else
         xvar2=exp(xvar1)
      endif
      tff=p(57)*(1.0+p(58)*q1)*(1.0+p(59)*xvar2*(slTF+mIf*mIf)*sgIf)
      Qbe=p(17)*qdbe*p(33)+tff*Ifi/qb
      Qbex=p(17)*qdbex*(1.0-p(33))
      Qbc=p(22)*qdbc+p(62)*Iri+p(23)*Kbci
      Qbcx=p(23)*Kbcx
      Qbep=p(24)*qdbep+p(62)*Ifp
      Qbcp=p(28)*qdbcp+p(88)*Vbcp
      Qbeo=Vbe*p(16)
      Qbco=Vbc*p(21)
c
c     Scale outputs
c
      if(SCALE.NE.1.0)then
         Ibe=SCALE*Ibe
         Ibex=SCALE*Ibex
         Itzf=SCALE*Itzf
         Itzr=SCALE*Itzr
         Ibc=SCALE*Ibc
         Ibep=SCALE*Ibep
         Ircx=SCALE*Ircx
         Irci=SCALE*Irci
         Irbx=SCALE*Irbx
         Irbi=SCALE*Irbi
         Ire=SCALE*Ire
         Irbp=SCALE*Irbp
         Qbe=SCALE*Qbe
         Qbex=SCALE*Qbex
         Qbc=SCALE*Qbc
         Qbcx=SCALE*Qbcx
         Qbep=SCALE*Qbep
         Qbeo=SCALE*Qbeo
         Qbco=SCALE*Qbco
         Ibcp=SCALE*Ibcp
         Iccp=SCALE*Iccp
         Irs=SCALE*Irs
         Qbcp=SCALE*Qbcp
      endif
      return
      end
